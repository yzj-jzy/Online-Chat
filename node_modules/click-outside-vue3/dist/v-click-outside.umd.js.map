{"version":3,"file":"v-click-outside.umd.js","sources":["../src/v-click-outside.js","../src/index.js"],"sourcesContent":["/**\n * Modified for Vue 3 from https://github.com/ndelvalle/v-click-outside\n * Cf. https://github.com/ndelvalle/v-click-outside/issues/238\n */\nconst HANDLERS_PROPERTY = \"__v-click-outside\";\nconst HAS_WINDOWS = typeof window !== \"undefined\";\nconst HAS_NAVIGATOR = typeof navigator !== \"undefined\";\nconst IS_TOUCH =\n  HAS_WINDOWS &&\n  (\"ontouchstart\" in window ||\n    (HAS_NAVIGATOR && navigator.msMaxTouchPoints > 0));\nconst EVENTS = IS_TOUCH ? [\"touchstart\"] : [\"click\"];\nconst processDirectiveArguments = (bindingValue) => {\n  const isFunction = typeof bindingValue === \"function\";\n  if (!isFunction && typeof bindingValue !== \"object\") {\n    throw new Error(\n      \"v-click-outside: Binding value must be a function or an object\"\n    );\n  }\n  return {\n    handler: isFunction ? bindingValue : bindingValue.handler,\n    middleware: bindingValue.middleware || ((item) => item),\n    events: bindingValue.events || EVENTS,\n    isActive: !(bindingValue.isActive === false),\n    detectIframe: !(bindingValue.detectIframe === false),\n    capture: Boolean(bindingValue.capture),\n  };\n};\nconst execHandler = ({ event, handler, middleware }) => {\n  if (middleware(event)) {\n    handler(event);\n  }\n};\nconst onFauxIframeClick = ({ el, event, handler, middleware }) => {\n  // Note: on firefox clicking on iframe triggers blur, but only on\n  //       next event loop it becomes document.activeElement\n  // https://stackoverflow.com/q/2381336#comment61192398_23231136\n  setTimeout(() => {\n    const { activeElement } = document;\n    if (\n      activeElement &&\n      activeElement.tagName === \"IFRAME\" &&\n      !el.contains(activeElement)\n    ) {\n      execHandler({ event, handler, middleware });\n    }\n  }, 0);\n};\nconst onEvent = ({ el, event, handler, middleware }) => {\n  // Note: composedPath is not supported on IE and Edge, more information here:\n  //       https://developer.mozilla.org/en-US/docs/Web/API/Event/composedPath\n  //       In the meanwhile, we are using el.contains for those browsers, not\n  //       the ideal solution, but using IE or EDGE is not ideal either.\n  const path = event.path || (event.composedPath && event.composedPath());\n  const isClickOutside = path\n    ? path.indexOf(el) < 0\n    : !el.contains(event.target);\n  if (!isClickOutside) {\n    return;\n  }\n  execHandler({ event, handler, middleware });\n};\nconst beforeMount = (el, { value }) => {\n  const {\n    events,\n    handler,\n    middleware,\n    isActive,\n    detectIframe,\n    capture,\n  } = processDirectiveArguments(value);\n  if (!isActive) {\n    return;\n  }\n  el[HANDLERS_PROPERTY] = events.map((eventName) => ({\n    event: eventName,\n    srcTarget: document.documentElement,\n    handler: (event) => onEvent({ el, event, handler, middleware }),\n    capture,\n  }));\n  if (detectIframe) {\n    const detectIframeEvent = {\n      event: \"blur\",\n      srcTarget: window,\n      handler: (event) => onFauxIframeClick({ el, event, handler, middleware }),\n      capture,\n    };\n    el[HANDLERS_PROPERTY] = [...el[HANDLERS_PROPERTY], detectIframeEvent];\n  }\n  el[HANDLERS_PROPERTY].forEach(({ event, srcTarget, handler: thisHandler }) =>\n    setTimeout(() => {\n      // Note: More info about this implementation can be found here:\n      //       https://github.com/ndelvalle/v-click-outside/issues/137\n      if (!el[HANDLERS_PROPERTY]) {\n        return;\n      }\n      srcTarget.addEventListener(event, thisHandler, capture);\n    }, 0)\n  );\n};\nconst unmounted = (el) => {\n  const handlers = el[HANDLERS_PROPERTY] || [];\n  handlers.forEach(({ event, srcTarget, handler, capture }) =>\n    srcTarget.removeEventListener(event, handler, capture)\n  );\n  delete el[HANDLERS_PROPERTY];\n};\nconst updated = (el, { value, oldValue }) => {\n  if (JSON.stringify(value) === JSON.stringify(oldValue)) {\n    return;\n  }\n  unmounted(el);\n  beforeMount(el, { value });\n};\nconst directive = {\n  beforeMount,\n  updated,\n  unmounted,\n};\nexport default HAS_WINDOWS ? directive : {};\n","import directive from './v-click-outside'\n\nconst plugin = {\n  install(Vue) {\n    Vue.directive('click-outside', directive)\n  },\n  directive,\n}\n\nexport default plugin\n"],"names":["HANDLERS_PROPERTY","HAS_WINDOWS","window","HAS_NAVIGATOR","navigator","EVENTS","msMaxTouchPoints","execHandler","event","handler","middleware","beforeMount","el","bindingValue","isFunction","Error","item","events","isActive","detectIframe","capture","Boolean","processDirectiveArguments","value","map","eventName","srcTarget","document","documentElement","path","composedPath","indexOf","contains","target","onEvent","detectIframeEvent","setTimeout","activeElement","tagName","onFauxIframeClick","forEach","thisHandler","addEventListener","unmounted","removeEventListener","updated","oldValue","JSON","stringify","install","Vue","directive"],"mappings":"qOAIA,IAAMA,EAAoB,oBACpBC,EAAgC,oBAAXC,OACrBC,EAAqC,oBAAdC,UAKvBC,EAHJJ,IACC,iBAAkBC,QAChBC,GAAiBC,UAAUE,iBAAmB,GACzB,CAAC,cAAgB,CAAC,SAiBtCC,EAAc,gBAAGC,IAAAA,MAAOC,IAAAA,SACxBC,IADiCA,YACtBF,IACbC,EAAQD,IAgCNG,EAAc,SAACC,WAlDa,SAACC,GACjC,IAAMC,EAAqC,mBAAjBD,EAC1B,IAAKC,GAAsC,iBAAjBD,EACxB,UAAUE,MACR,kEAGJ,MAAO,CACLN,QAASK,EAAaD,EAAeA,EAAaJ,QAClDC,WAAYG,EAAaH,YAAe,SAACM,UAASA,GAClDC,OAAQJ,EAAaI,QAAUZ,EAC/Ba,YAAsC,IAA1BL,EAAaK,UACzBC,gBAA8C,IAA9BN,EAAaM,cAC7BC,QAASC,QAAQR,EAAaO,UA6C5BE,GARqBC,OAGvBd,IAAAA,QACAC,IAAAA,WAEAS,IAAAA,aACAC,IAAAA,QAEF,KAJEF,SAIF,CASA,GANAN,EAAGZ,KAVDiB,OAU6BO,IAAI,SAACC,SAAe,CACjDjB,MAAOiB,EACPC,UAAWC,SAASC,gBACpBnB,QAAS,SAACD,UA7BE,gBAAGI,IAAAA,GAAIJ,IAAAA,MAAOC,IAAAA,QAASC,IAAAA,WAK/BmB,EAAOrB,EAAMqB,MAASrB,EAAMsB,cAAgBtB,EAAMsB,gBACjCD,EACnBA,EAAKE,QAAQnB,GAAM,GAClBA,EAAGoB,SAASxB,EAAMyB,UAIvB1B,EAAY,CAAEC,MAAAA,EAAOC,QAAAA,EAASC,WAAAA,IAiBRwB,CAAQ,CAAEtB,GAAAA,EAAIJ,MAAAA,EAAOC,QAAAA,EAASC,WAAAA,KAClDU,QAAAA,KAEED,EAAc,CAChB,IAAMgB,EAAoB,CACxB3B,MAAO,OACPkB,UAAWxB,OACXO,QAAS,SAACD,UAnDU,gBAAGI,IAAAA,GAAIJ,IAAAA,MAAOC,IAAAA,QAASC,IAAAA,WAI/C0B,WAAW,eACDC,EAAkBV,SAAlBU,cAENA,GAC0B,WAA1BA,EAAcC,UACb1B,EAAGoB,SAASK,IAEb9B,EAAY,CAAEC,MAAAA,EAAOC,QAAAA,EAASC,WAAAA,KAE/B,GAsCqB6B,CAAkB,CAAE3B,GAAAA,EAAIJ,MAAAA,EAAOC,QAAAA,EAASC,WAAAA,KAC5DU,QAAAA,GAEFR,EAAGZ,aAAyBY,EAAGZ,IAAoBmC,IAErDvB,EAAGZ,GAAmBwC,QAAQ,gBAAGhC,IAAAA,MAAOkB,IAAAA,UAAoBe,IAAThC,eACjD2B,WAAW,WAGJxB,EAAGZ,IAGR0B,EAAUgB,iBAAiBlC,EAAOiC,EAAarB,IAC9C,OAGDuB,EAAY,SAAC/B,IACAA,EAAGZ,IAAsB,IACjCwC,QAAQ,qBAAUd,UACfkB,sBADQpC,QAAkBC,UAASW,kBAGxCR,EAAGZ,MAcGC,EALG,CAChBU,YAAAA,EACAkC,QATc,SAACjC,SAAMW,IAAAA,MAAOuB,IAAAA,SACxBC,KAAKC,UAAUzB,KAAWwB,KAAKC,UAAUF,KAG7CH,EAAU/B,GACVD,EAAYC,EAAI,CAAEW,MAAAA,MAKlBoB,UAAAA,GAEuC,SCrH1B,CACbM,iBAAQC,GACNA,EAAIC,UAAU,gBAAiBA,IAEjCA,UAAAA"}